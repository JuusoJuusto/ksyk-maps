üîç HOW TO DEBUG LOGIN ON VERCEL
================================

The code has been updated with EXTENSIVE logging. Here's how to see what's happening:

STEP 1: DEPLOY THE LATEST CODE
-------------------------------
Run these commands:
  git add .
  git commit -m "Add detailed login logging"
  git push

Wait 1-2 minutes for Vercel to deploy automatically.


STEP 2: ACCESS VERCEL LOGS
---------------------------
Option A - Via Vercel Dashboard:
  1. Go to https://vercel.com
  2. Click on your project (ksyk-map or similar)
  3. Click "Deployments" tab
  4. Click on the latest deployment (should say "Ready")
  5. Click "Functions" tab
  6. Click on any function (like "api/index")
  7. Click "Logs" or "Real-time Logs"

Option B - Via Vercel CLI:
  1. Install: npm i -g vercel
  2. Login: vercel login
  3. Link project: vercel link
  4. View logs: vercel logs --follow


STEP 3: TRY TO LOGIN
---------------------
1. Open your Vercel app URL (e.g., https://your-app.vercel.app)
2. Go to Admin Login page
3. Try to login with:
   Email: omelimeilit@gmail.com
   Password: test

4. Watch the Vercel logs in real-time


STEP 4: WHAT TO LOOK FOR IN LOGS
---------------------------------
You should see these log messages:

‚úÖ GOOD SIGNS:
  üîê LOGIN ATTEMPT: { email: 'omelimeilit@gmail.com', passwordLength: 4 }
  üö® BYPASS CHECK: { isOmelimeilitEmail: true, isValidBypassPassword: true, ... }
  üö® EMERGENCY BYPASS ACTIVATED for omelimeilit@gmail.com
  üë§ User from DB: FOUND
  üîë Attempting req.login...
  ‚úÖ Emergency bypass login successful

‚ùå BAD SIGNS:
  - "Firebase initialization error" ‚Üí Firebase credentials not set
  - "Session creation error" ‚Üí Session middleware issue
  - "User from DB: NOT FOUND" ‚Üí Firebase connection issue
  - "willBypass: false" ‚Üí Password doesn't match expected values


STEP 5: COMMON ISSUES & FIXES
------------------------------

ISSUE: Firebase credentials not found
FIX: Add FIREBASE_SERVICE_ACCOUNT to Vercel environment variables
  1. Go to Vercel Dashboard ‚Üí Project ‚Üí Settings ‚Üí Environment Variables
  2. Add: FIREBASE_SERVICE_ACCOUNT
  3. Value: Copy entire content from serviceAccountKey.json
  4. Save and redeploy

ISSUE: Session errors
FIX: Add SESSION_SECRET to Vercel environment variables
  1. Add: SESSION_SECRET
  2. Value: ksyk-map-super-secret-key-change-in-production-2024
  3. Save and redeploy

ISSUE: Password doesn't match
FIX: The emergency bypass accepts these passwords:
  - test
  - test123
  - OwlAppsOkko
  Make sure you're typing exactly one of these (case-sensitive!)


STEP 6: ALTERNATIVE - TEST LOCALLY FIRST
-----------------------------------------
Before debugging on Vercel, test locally:
  1. npm run dev
  2. Open http://localhost:5000
  3. Try login with omelimeilit@gmail.com / test
  4. Check console logs

If it works locally but not on Vercel:
  ‚Üí Environment variables issue on Vercel
  ‚Üí Check Firebase credentials are set correctly


CURRENT STATUS
--------------
‚úÖ User exists in Firebase: omelimeilit@gmail.com
‚úÖ Password is set: test
‚úÖ Emergency bypass is active in code
‚úÖ Normal login also should work
‚úÖ Detailed logging added

NEXT: Deploy and check Vercel logs to see actual error!
